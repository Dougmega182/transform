(()=>{var e={};e.id=399,e.ids=[399],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},42832:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>l});var s=r(70260),n=r(28203),a=r(25155),i=r.n(a),d=r(67292),o={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>d[e]);r.d(t,o);let l=["",{children:["job-sites",{children:["[id]",{children:["attendance",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,59977)),"E:\\signonsite\\transform\\app\\job-sites\\[id]\\attendance\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,19611)),"E:\\signonsite\\transform\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"]}],c=["E:\\signonsite\\transform\\app\\job-sites\\[id]\\attendance\\page.tsx"],m={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/job-sites/[id]/attendance/page",pathname:"/job-sites/[id]/attendance",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},9582:(e,t,r)=>{Promise.resolve().then(r.bind(r,59977))},72630:(e,t,r)=>{Promise.resolve().then(r.bind(r,96973))},96973:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(45512),n=r(58009),a=r(79334),i=r(7777),d=r(87021),o=r(97643),l=r(13393),c=r(77252),m=r(35668);let u=(0,r(41680).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var x=r(28531),f=r.n(x),p=r(65518),h=r(63917);function g(){let{user:e}=(0,i.A)();(0,a.useRouter)(),(0,a.useParams)();let{toast:t}=(0,p.dj)(),[r,x]=(0,n.useState)(null),[g,j]=(0,n.useState)([]),[b,v]=(0,n.useState)(!0),N=async e=>{try{if(!(await fetch(`/api/attendance/${e}/sign-out`,{method:"POST"})).ok)throw Error("Failed to sign out");j(t=>t.map(t=>t.id===e?{...t,signOutTime:new Date().toISOString()}:t)),t({title:"Signed out",description:"Worker has been signed out successfully"})}catch(e){console.error("Error signing out:",e),t({variant:"destructive",title:"Error",description:"Failed to sign out worker"})}};if(b)return(0,s.jsx)("div",{className:"container flex h-[calc(100vh-4rem)] items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-lg font-medium",children:"Loading..."}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please wait while we load attendance data"})]})});if(!r)return(0,s.jsx)("div",{className:"container py-10",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-lg font-medium",children:"Job site not found"}),(0,s.jsx)(d.$,{asChild:!0,className:"mt-4",children:(0,s.jsx)(f(),{href:"/job-sites",children:"Back to Job Sites"})})]})});let y=e=>(0,h.GP)(new Date(e),"dd MMM yyyy, h:mm a"),w=(e,t)=>{if(!t)return null;let r=new Date(e).getTime(),s=new Date(t).getTime()-r,n=Math.floor(s/36e5),a=Math.floor(s%36e5/6e4);return`${n}h ${a}m`};return(0,s.jsxs)("div",{className:"container py-10",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)(d.$,{variant:"ghost",asChild:!0,className:"mb-4",children:(0,s.jsxs)(f(),{href:`/job-sites/${r.id}`,children:[(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Back to Site Details"]})}),(0,s.jsxs)("h1",{className:"text-3xl font-bold",children:[r.name," - Attendance"]}),(0,s.jsx)("p",{className:"text-muted-foreground",children:r.address})]}),(0,s.jsxs)(o.Zp,{children:[(0,s.jsxs)(o.aR,{children:[(0,s.jsx)(o.ZB,{children:"Site Attendance"}),(0,s.jsx)(o.BT,{children:"View and manage worker attendance for this job site"})]}),(0,s.jsx)(o.Wu,{children:0===g.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-10",children:[(0,s.jsx)("p",{className:"mb-4 text-muted-foreground",children:"No attendance records found"}),(0,s.jsx)(d.$,{asChild:!0,children:(0,s.jsx)(f(),{href:`/job-sites/${r.id}/sign-in`,children:"Sign In to Site"})})]}):(0,s.jsxs)(l.XI,{children:[(0,s.jsx)(l.A0,{children:(0,s.jsxs)(l.Hj,{children:[(0,s.jsx)(l.nd,{children:"Worker"}),(0,s.jsx)(l.nd,{children:"Sign In Time"}),(0,s.jsx)(l.nd,{children:"Sign Out Time"}),(0,s.jsx)(l.nd,{children:"Duration"}),(0,s.jsx)(l.nd,{children:"Status"}),(0,s.jsx)(l.nd,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(l.BF,{children:g.map(e=>(0,s.jsxs)(l.Hj,{children:[(0,s.jsx)(l.nA,{children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.userName}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.userEmail})]})}),(0,s.jsx)(l.nA,{children:y(e.signInTime)}),(0,s.jsx)(l.nA,{children:e.signOutTime?y(e.signOutTime):"-"}),(0,s.jsx)(l.nA,{children:w(e.signInTime,e.signOutTime)||"-"}),(0,s.jsx)(l.nA,{children:e.signOutTime?(0,s.jsx)(c.E,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"Completed"}):(0,s.jsx)(c.E,{className:"bg-blue-500",children:"On Site"})}),(0,s.jsx)(l.nA,{className:"text-right",children:!e.signOutTime&&(0,s.jsxs)(d.$,{variant:"outline",size:"sm",onClick:()=>N(e.id),children:[(0,s.jsx)(u,{className:"mr-2 h-4 w-4"})," Sign Out"]})})]},e.id))})]})})]})]})}},77252:(e,t,r)=>{"use strict";r.d(t,{E:()=>d});var s=r(45512);r(58009);var n=r(21643),a=r(59462);let i=(0,n.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d({className:e,variant:t,...r}){return(0,s.jsx)("div",{className:(0,a.cn)(i({variant:t}),e),...r})}},97643:(e,t,r)=>{"use strict";r.d(t,{BT:()=>l,Wu:()=>c,ZB:()=>o,Zp:()=>i,aR:()=>d,wL:()=>m});var s=r(45512),n=r(58009),a=r(59462);let i=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));i.displayName="Card";let d=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...t}));d.displayName="CardHeader";let o=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let l=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",e),...t}));l.displayName="CardDescription";let c=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent";let m=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...t}));m.displayName="CardFooter"},13393:(e,t,r)=>{"use strict";r.d(t,{A0:()=>d,BF:()=>o,Hj:()=>l,XI:()=>i,nA:()=>m,nd:()=>c});var s=r(45512),n=r(58009),a=r(59462);let i=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:r,className:(0,a.cn)("w-full caption-bottom text-sm",e),...t})}));i.displayName="Table";let d=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("thead",{ref:r,className:(0,a.cn)("[&_tr]:border-b",e),...t}));d.displayName="TableHeader";let o=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tbody",{ref:r,className:(0,a.cn)("[&_tr:last-child]:border-0",e),...t}));o.displayName="TableBody",n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tfoot",{ref:r,className:(0,a.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t})).displayName="TableFooter";let l=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tr",{ref:r,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));l.displayName="TableRow";let c=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("th",{ref:r,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));c.displayName="TableHead";let m=n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("td",{ref:r,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));m.displayName="TableCell",n.forwardRef(({className:e,...t},r)=>(0,s.jsx)("caption",{ref:r,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption"},35668:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(41680).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},59977:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"E:\\\\signonsite\\\\transform\\\\app\\\\job-sites\\\\[id]\\\\attendance\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"E:\\signonsite\\transform\\app\\job-sites\\[id]\\attendance\\page.tsx","default")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,178,917,739],()=>r(42832));module.exports=s})();