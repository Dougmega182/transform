(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[308],{2032:(e,s,t)=>{Promise.resolve().then(t.bind(t,6390))},6390:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>S});var a=t(5155),i=t(2115),r=t(6046),n=t(1289),l=t(4085),c=t(2336),d=t(5785),o=t(371),h=t(5007),u=t(745),m=t(1641),x=t(9134),j=t(7364),v=t(5686),p=t(3473),f=t(7780),g=t(8173),w=t.n(g),N=t(208);function S(){let{user:e,loading:s}=(0,n.A)(),t=(0,r.useRouter)(),{toast:g}=(0,x.dj)(),[S,y]=(0,i.useState)("details"),[k,b]=(0,i.useState)([{id:"hazard_1",description:"",controls:"",riskLevel:"medium"}]),[C,z]=(0,i.useState)(null);if((0,i.useEffect)(()=>{s||e||t.push("/auth/login")},[e,s,t]),s)return(0,a.jsx)("div",{className:"container flex h-[calc(100vh-4rem)] items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-lg font-medium",children:"Loading..."}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please wait"})]})});if(!e)return null;let W=(e,s,t)=>{b(k.map(a=>a.id===e?{...a,[s]:t}:a))},M=e=>{k.length>1?b(k.filter(s=>s.id!==e)):g({title:"Cannot remove hazard",description:"You must have at least one hazard in your SWMS",variant:"destructive"})};return(0,a.jsxs)("div",{className:"container py-10",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)(l.$,{variant:"ghost",asChild:!0,className:"mb-4",children:(0,a.jsxs)(w(),{href:"/swms",children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"})," Back to SWMS"]})}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Create New SWMS"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Create a new Safe Work Method Statement"})]}),(0,a.jsxs)(m.tU,{value:S,onValueChange:y,className:"space-y-4",children:[(0,a.jsxs)(m.j7,{children:[(0,a.jsx)(m.Xi,{value:"details",children:"Details"}),(0,a.jsx)(m.Xi,{value:"hazards",children:"Hazards & Controls"}),(0,a.jsx)(m.Xi,{value:"signature",children:"Signature"})]}),(0,a.jsx)(m.av,{value:"details",className:"space-y-4",children:(0,a.jsxs)(h.Zp,{children:[(0,a.jsxs)(h.aR,{children:[(0,a.jsx)(h.ZB,{children:"SWMS Details"}),(0,a.jsx)(h.BT,{children:"Basic information about the work and location"})]}),(0,a.jsxs)(h.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"title",children:"Work Activity Title"}),(0,a.jsx)(c.p,{id:"title",placeholder:"e.g., Excavation Work"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"location",children:"Project/Location"}),(0,a.jsx)(c.p,{id:"location",placeholder:"Project name or site location"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"description",children:"Work Description"}),(0,a.jsx)(o.T,{id:"description",placeholder:"Describe the work to be performed",rows:4})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"company",children:"Company Name"}),(0,a.jsx)(c.p,{id:"company",placeholder:"Your company name"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"supervisor",children:"Supervisor"}),(0,a.jsx)(c.p,{id:"supervisor",placeholder:"Name of supervisor"})]})]})]}),(0,a.jsx)(h.wL,{children:(0,a.jsx)(l.$,{onClick:()=>y("hazards"),children:"Continue to Hazards & Controls"})})]})}),(0,a.jsx)(m.av,{value:"hazards",className:"space-y-4",children:(0,a.jsxs)(h.Zp,{children:[(0,a.jsxs)(h.aR,{children:[(0,a.jsx)(h.ZB,{children:"Hazards & Controls"}),(0,a.jsx)(h.BT,{children:"Identify hazards and control measures"})]}),(0,a.jsxs)(h.Wu,{className:"space-y-6",children:[k.map((e,s)=>(0,a.jsxs)("div",{className:"space-y-4 rounded-lg border p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium",children:["Hazard ",s+1]}),(0,a.jsx)(l.$,{variant:"ghost",size:"icon",onClick:()=>M(e.id),disabled:1===k.length,children:(0,a.jsx)(v.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"hazard-desc-".concat(e.id),children:"Hazard Description"}),(0,a.jsx)(o.T,{id:"hazard-desc-".concat(e.id),value:e.description,onChange:s=>W(e.id,"description",s.target.value),placeholder:"Describe the hazard...",rows:2})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"hazard-controls-".concat(e.id),children:"Control Measures"}),(0,a.jsx)(o.T,{id:"hazard-controls-".concat(e.id),value:e.controls,onChange:s=>W(e.id,"controls",s.target.value),placeholder:"List control measures to mitigate this hazard...",rows:3})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"risk-level-".concat(e.id),children:"Risk Level"}),(0,a.jsxs)(u.l6,{value:e.riskLevel,onValueChange:s=>W(e.id,"riskLevel",s),children:[(0,a.jsx)(u.bq,{id:"risk-level-".concat(e.id),children:(0,a.jsx)(u.yv,{placeholder:"Select risk level"})}),(0,a.jsxs)(u.gC,{children:[(0,a.jsx)(u.eb,{value:"low",children:"Low"}),(0,a.jsx)(u.eb,{value:"medium",children:"Medium"}),(0,a.jsx)(u.eb,{value:"high",children:"High"}),(0,a.jsx)(u.eb,{value:"extreme",children:"Extreme"})]})]})]})]},e.id)),(0,a.jsxs)(l.$,{variant:"outline",onClick:()=>{let e={id:"hazard_".concat(k.length+1),description:"",controls:"",riskLevel:"medium"};b([...k,e])},className:"w-full",children:[(0,a.jsx)(p.A,{className:"mr-2 h-4 w-4"})," Add Hazard"]})]}),(0,a.jsxs)(h.wL,{className:"flex justify-between",children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>y("details"),children:"Back to Details"}),(0,a.jsx)(l.$,{onClick:()=>y("signature"),children:"Continue to Signature"})]})]})}),(0,a.jsx)(m.av,{value:"signature",className:"space-y-4",children:(0,a.jsxs)(h.Zp,{children:[(0,a.jsxs)(h.aR,{children:[(0,a.jsx)(h.ZB,{children:"Sign SWMS"}),(0,a.jsx)(h.BT,{children:"Review and sign the Safe Work Method Statement"})]}),(0,a.jsxs)(h.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium",children:"Declaration"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"I have read and understood this Safe Work Method Statement (SWMS). I agree to comply with the control measures outlined in this SWMS. I understand that I must stop work immediately and notify my supervisor if the SWMS cannot be followed or if new hazards are identified."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"signature",children:"Signature"}),(0,a.jsx)("div",{className:"rounded-lg border p-4",children:(0,a.jsx)(N.A,{onSave:z})}),C&&(0,a.jsx)("p",{className:"text-sm text-green-600",children:"Signature captured successfully"})]})]}),(0,a.jsxs)(h.wL,{className:"flex justify-between",children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>y("hazards"),children:"Back to Hazards"}),(0,a.jsxs)(l.$,{onClick:()=>{if(!C){g({title:"Signature required",description:"Please sign the SWMS before submitting",variant:"destructive"});return}g({title:"SWMS submitted",description:"Your Safe Work Method Statement has been submitted for approval"}),t.push("/swms")},children:[(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"})," Submit SWMS"]})]})]})})]})]})}},208:(e,s,t)=>{"use strict";t.d(s,{A:()=>d});var a=t(5155),i=t(2115),r=t(4085);let n=(0,t(7401).A)("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);var l=t(7780),c=t(90);function d(e){let{onSave:s}=e,t=(0,i.useRef)(null),[d,o]=(0,i.useState)(!1),[h,u]=(0,i.useState)(null),m=(0,c.useMobile)();(0,i.useEffect)(()=>{let e=t.current;if(!e)return;let s=e.getContext("2d");if(!s)return;e.width=e.offsetWidth,e.height=200,s.lineWidth=2,s.lineCap="round",s.strokeStyle="#000",u(s);let a=()=>{if(!e||!s)return;let t=document.createElement("canvas"),a=t.getContext("2d");a&&(t.width=e.width,t.height=e.height,a.drawImage(e,0,0),e.width=e.offsetWidth,e.height=200,s.lineWidth=2,s.lineCap="round",s.strokeStyle="#000",s.drawImage(t,0,0))};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);let x=e=>{if(!h)return;o(!0),h.beginPath();let{offsetX:s,offsetY:t}=p(e);h.moveTo(s,t)},j=e=>{if(!d||!h)return;let{offsetX:s,offsetY:t}=p(e);h.lineTo(s,t),h.stroke()},v=()=>{h&&(o(!1),h.closePath())},p=e=>{let s,a;let i=t.current;if(!i)return{offsetX:0,offsetY:0};if(f(e)){let t=i.getBoundingClientRect(),r=e.touches[0]||e.changedTouches[0];s=r.clientX-t.left,a=r.clientY-t.top}else s=e.nativeEvent.offsetX,a=e.nativeEvent.offsetY;return{offsetX:s,offsetY:a}},f=e=>"touches"in e;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"border rounded-md bg-white",children:(0,a.jsx)("canvas",{ref:t,className:"w-full touch-none cursor-crosshair",onMouseDown:x,onMouseMove:j,onMouseUp:v,onMouseLeave:v,onTouchStart:x,onTouchMove:j,onTouchEnd:v})}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{h&&t.current&&(h.clearRect(0,0,t.current.width,t.current.height),s(null))},children:[(0,a.jsx)(n,{className:"h-4 w-4 mr-2"})," Clear"]}),(0,a.jsxs)(r.$,{size:"sm",onClick:()=>{t.current&&s(t.current.toDataURL("image/png"))},children:[(0,a.jsx)(l.A,{className:"h-4 w-4 mr-2"})," Save Signature"]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:m?"Use your finger to sign above":"Use your mouse to sign above"})]})}},90:(e,s,t)=>{"use strict";t.d(s,{a:()=>i});var a=t(2115);function i(){let[e,s]=a.useState(void 0);return a.useEffect(()=>{let e=window.matchMedia("(max-width: ".concat(767,"px)")),t=()=>{s(window.innerWidth<768)};return e.addEventListener("change",t),s(window.innerWidth<768),()=>e.removeEventListener("change",t)},[]),!!e}}},e=>{var s=s=>e(e.s=s);e.O(0,[882,173,934,708,894,891,441,517,358],()=>s(2032)),_N_E=e.O()}]);