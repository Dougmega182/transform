(()=>{var e={};e.id=159,e.ids=[159],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},61444:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o});var r=t(70260),i=t(28203),n=t(25155),a=t.n(n),d=t(67292),l={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);t.d(s,l);let o=["",{children:["job-sites",{children:["[id]",{children:["sign-in",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,19243)),"E:\\signonsite\\transform\\app\\job-sites\\[id]\\sign-in\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,19611)),"E:\\signonsite\\transform\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"]}],c=["E:\\signonsite\\transform\\app\\job-sites\\[id]\\sign-in\\page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/job-sites/[id]/sign-in/page",pathname:"/job-sites/[id]/sign-in",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},36990:(e,s,t)=>{Promise.resolve().then(t.bind(t,19243))},77158:(e,s,t)=>{Promise.resolve().then(t.bind(t,62679))},62679:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var r=t(45512),i=t(58009),n=t(79334),a=t(7777),d=t(87021),l=t(97643),o=t(65518),c=t(35668),u=t(94172),m=t(46583),h=t(28531),x=t.n(h),p=t(36516);function f(){let{user:e}=(0,a.A)(),s=(0,n.useRouter)();(0,n.useParams)();let{toast:t}=(0,o.dj)(),[h,f]=(0,i.useState)(null),[j,g]=(0,i.useState)([]),[v,N]=(0,i.useState)([]),[y,b]=(0,i.useState)(null),[S,w]=(0,i.useState)(!0),[C,k]=(0,i.useState)(!1),[A,M]=(0,i.useState)(1),P=async()=>{if(!y){t({variant:"destructive",title:"Signature required",description:"Please provide your signature to sign in"});return}k(!0);try{if(!(await fetch("/api/attendance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jobSiteId:h?.id,signature:y})})).ok)throw Error("Failed to sign in");t({title:"Signed in successfully",description:`You have been signed in to ${h?.name}`}),s.push(`/job-sites/${h?.id}`)}catch(e){console.error("Error signing in:",e),t({variant:"destructive",title:"Sign in failed",description:e instanceof Error?e.message:"An error occurred during sign in"})}finally{k(!1)}};if(S)return(0,r.jsx)("div",{className:"container flex h-[calc(100vh-4rem)] items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-lg font-medium",children:"Loading..."}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please wait while we load site data"})]})});if(!h)return(0,r.jsx)("div",{className:"container py-10",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-lg font-medium",children:"Job site not found"}),(0,r.jsx)(d.$,{asChild:!0,className:"mt-4",children:(0,r.jsx)(x(),{href:"/job-sites",children:"Back to Job Sites"})})]})});let R=j.every(e=>e.completed),E=v.every(e=>e.signed);return(0,r.jsxs)("div",{className:"container py-10",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)(d.$,{variant:"ghost",asChild:!0,className:"mb-4",children:(0,r.jsxs)(x(),{href:`/job-sites/${h.id}`,children:[(0,r.jsx)(c.A,{className:"mr-2 h-4 w-4"})," Back to Site Details"]})}),(0,r.jsxs)("h1",{className:"text-3xl font-bold",children:["Sign In to ",h.name]}),(0,r.jsx)("p",{className:"text-muted-foreground",children:h.address})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[1===A&&(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsx)(l.ZB,{children:"Site Inductions"}),(0,r.jsx)(l.BT,{children:"Complete all required inductions before signing in"})]}),(0,r.jsx)(l.Wu,{children:0===j.length?(0,r.jsx)("p",{className:"text-center py-4",children:"No inductions required for this site"}):(0,r.jsx)("div",{className:"space-y-4",children:j.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(u.A,{className:"h-5 w-5 mr-2 text-muted-foreground"}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"font-medium",children:e.title})})]}),(0,r.jsx)("div",{children:e.completed?(0,r.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 mr-1"}),(0,r.jsx)("span",{children:"Completed"})]}):(0,r.jsx)(d.$,{size:"sm",onClick:()=>s.push(`/inductions/${e.id}`),children:"Complete Induction"})})]},e.id))})}),(0,r.jsx)(l.wL,{children:(0,r.jsx)(d.$,{onClick:()=>M(2),disabled:!R,children:R?"Continue to SWMS":"Complete All Inductions to Continue"})})]}),2===A&&(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsx)(l.ZB,{children:"Safe Work Method Statements"}),(0,r.jsx)(l.BT,{children:"Review and sign all required SWMS before signing in"})]}),(0,r.jsx)(l.Wu,{children:0===v.length?(0,r.jsx)("p",{className:"text-center py-4",children:"No SWMS required for this site"}):(0,r.jsx)("div",{className:"space-y-4",children:v.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(u.A,{className:"h-5 w-5 mr-2 text-muted-foreground"}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"font-medium",children:e.title})})]}),(0,r.jsx)("div",{children:e.signed?(0,r.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 mr-1"}),(0,r.jsx)("span",{children:"Signed"})]}):(0,r.jsx)(d.$,{size:"sm",onClick:()=>s.push(`/swms/${e.id}`),children:"Review & Sign"})})]},e.id))})}),(0,r.jsxs)(l.wL,{className:"flex justify-between",children:[(0,r.jsx)(d.$,{variant:"outline",onClick:()=>M(1),children:"Back to Inductions"}),(0,r.jsx)(d.$,{onClick:()=>M(3),disabled:!E,children:E?"Continue to Sign In":"Sign All SWMS to Continue"})]})]}),3===A&&(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsx)(l.ZB,{children:"Sign In to Site"}),(0,r.jsx)(l.BT,{children:"Provide your signature to complete the sign-in process"})]}),(0,r.jsxs)(l.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,r.jsx)("h3",{className:"mb-4 text-lg font-medium",children:"Declaration"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"I confirm that I have completed all required inductions and reviewed all Safe Work Method Statements for this site. I understand and will comply with all safety requirements and procedures."})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-medium",children:"Signature"}),(0,r.jsx)("div",{className:"rounded-lg border p-4",children:(0,r.jsx)(p.A,{onSave:b})}),y&&(0,r.jsx)("p",{className:"text-sm text-green-600",children:"Signature captured successfully"})]})]}),(0,r.jsxs)(l.wL,{className:"flex justify-between",children:[(0,r.jsx)(d.$,{variant:"outline",onClick:()=>M(2),children:"Back to SWMS"}),(0,r.jsx)(d.$,{onClick:P,disabled:!y||C,children:C?"Signing In...":"Complete Sign In"})]})]})]})]})}},36516:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var r=t(45512),i=t(58009),n=t(87021);let a=(0,t(41680).A)("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);var d=t(33680),l=t(77350);function o({onSave:e}){let s=(0,i.useRef)(null),[t,o]=(0,i.useState)(!1),[c,u]=(0,i.useState)(null),m=(0,l.useMobile)(),h=e=>{if(!c)return;o(!0),c.beginPath();let{offsetX:s,offsetY:t}=f(e);c.moveTo(s,t)},x=e=>{if(!t||!c)return;let{offsetX:s,offsetY:r}=f(e);c.lineTo(s,r),c.stroke()},p=()=>{c&&(o(!1),c.closePath())},f=e=>{let t,r;let i=s.current;if(!i)return{offsetX:0,offsetY:0};if(j(e)){let s=i.getBoundingClientRect(),n=e.touches[0]||e.changedTouches[0];t=n.clientX-s.left,r=n.clientY-s.top}else t=e.nativeEvent.offsetX,r=e.nativeEvent.offsetY;return{offsetX:t,offsetY:r}},j=e=>"touches"in e;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"border rounded-md bg-white",children:(0,r.jsx)("canvas",{ref:s,className:"w-full touch-none cursor-crosshair",onMouseDown:h,onMouseMove:x,onMouseUp:p,onMouseLeave:p,onTouchStart:h,onTouchMove:x,onTouchEnd:p})}),(0,r.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,r.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>{c&&s.current&&(c.clearRect(0,0,s.current.width,s.current.height),e(null))},children:[(0,r.jsx)(a,{className:"h-4 w-4 mr-2"})," Clear"]}),(0,r.jsxs)(n.$,{size:"sm",onClick:()=>{s.current&&e(s.current.toDataURL("image/png"))},children:[(0,r.jsx)(d.A,{className:"h-4 w-4 mr-2"})," Save Signature"]})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:m?"Use your finger to sign above":"Use your mouse to sign above"})]})}},97643:(e,s,t)=>{"use strict";t.d(s,{BT:()=>o,Wu:()=>c,ZB:()=>l,Zp:()=>a,aR:()=>d,wL:()=>u});var r=t(45512),i=t(58009),n=t(59462);let a=i.forwardRef(({className:e,...s},t)=>(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));a.displayName="Card";let d=i.forwardRef(({className:e,...s},t)=>(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...s}));d.displayName="CardHeader";let l=i.forwardRef(({className:e,...s},t)=>(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));l.displayName="CardTitle";let o=i.forwardRef(({className:e,...s},t)=>(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",e),...s}));o.displayName="CardDescription";let c=i.forwardRef(({className:e,...s},t)=>(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",e),...s}));c.displayName="CardContent";let u=i.forwardRef(({className:e,...s},t)=>(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",e),...s}));u.displayName="CardFooter"},35668:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},46583:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},33680:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},19243:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"E:\\\\signonsite\\\\transform\\\\app\\\\job-sites\\\\[id]\\\\sign-in\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"E:\\signonsite\\transform\\app\\job-sites\\[id]\\sign-in\\page.tsx","default")}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[638,178,739],()=>t(61444));module.exports=r})();